<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    /*检测浏览器是否支持sessionStorage和localStorage*/
    function checkStorageSupport() {
        //sessionStorage
        if (window.sessionStorage) {
            return true;
        } else {
            return false;
        }
        //localStorage
        if (window.localStorage) {
            return true;
        } else {
            return false;
        }
    }

    //存入/读取数据
    //存入
    sessionStorage.setItem("key","value");
    localStorage.setItem("key","value");
    //读取
    sessionStorage.getItem("key");
    localStorage.getItem("key");

    //清除数据
        //removeItem方法用于清除某个键名对应的数据
    sessionStorage.removeItem("key");
    localStorage.removeItem("key");
        //clear方法用于清除所有保存的数据
    sessionStorage.clear();
    localStorage.clear();

    //便利操作
    //利用length属性和key方法，可以遍历所有的键
    for (var i = 0; i < localStorage.length; i++) {
        console.log(localStorage.key(i));
    }

    //storage事件
    //当储存的数据发生变化时，会触发storage事件。我们可以指定这个事件的回调函数。
    window.addEventListener("storage",onStorageChange);
    //回调函数接受一个event对象作为参数。这个event对象的key属性，保存发生变化的键名。
    function onStorageChange(e) {
        console.log(e.key);
    }
    //除了key属性，event对象的属性还有三个：
        /*oldValue：更新前的值。如果该键为新增加，则这个属性为null
        * newValue：更新后的值。如果该键被删除，则这个属性为null
        * url：原始触发storage事件的那个网页的网址*/

        /*值得特别注意的是，该事件不在导致数据变化的当前页面触发*/

    document.write("值得特别注意的是，该事件不在导致数据变化的当前页面触发。如果浏览器同时打开一个域名下面的多个页面，当其中的一个页面改变sessionStorage或localStorage的数据时，其他所有页面的storage事件会被触发，而原始页面并不触发storage事件。可以通过这种机制，实现多个窗口之间的通信。所有浏览器之中，只有IE浏览器除外，它会在所有页面触发storage事件。");
</script>
</body>
</html>